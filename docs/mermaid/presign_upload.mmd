sequenceDiagram
  autonumber
  participant Client
  participant API as Control‑Plane API
  participant Auth as AuthN/Z
  participant S3 as S3 (bucket)

  Client->>API: POST /v1/presign/upload { tenant_id, object_key, content_type, max_size }
  API->>Auth: Validate token → (tenant_id, role)
  Auth-->>API: OK (role permits PUT)
  API->>API: Normalize/validate key → tenants/&lt;tenant_id&gt;/&lt;object_key&gt;
  API->>S3: Generate presigned PUT URL (TTL ≤ 10m)
  S3-->>API: { url, headers, expires_at }
  API-->>Client: 200 { url, method: PUT, headers, expires_at }

  Note over Client,S3: Client uploads directly to S3 using the presigned URL
